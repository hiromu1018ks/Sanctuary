# SNSアプリ「Sanctuary」開発ロードマップ（個人開発版）

**作成日:** 2025年7月10日  
**最終更新:** 2025年7月27日  
**バージョン:** 5.2.0 (Auth.js v5 Google認証完全実装版)
**作成者:** 個人開発者  
**プロジェクト:** "ありがとう" と "応援" が育つ、心の安全地帯  
**開発形態:** 個人開発（1名）

**関連ドキュメント:**
-   [企画書](./新規SNSアプリ「Sanctuary（サンクチュアリ）」企画書.md)
-   [要件定義書](./SNSアプリ「Sanctuary」要件定義書.md)
-   [データベース設計書](./SNSアプリ「Sanctuary」データベース設計書.md)
-   [機能仕様書](./SNSアプリ「Sanctuary」機能仕様書.md)
-   [画面遷移図](./SNSアプリ「Sanctuary」画面遷移図.md)
-   [主要画面要素定義](./SNSアプリ「Sanctuary」主要画面要素定義.md)

---

## **1. MVP（Minimum Viable Product）の定義**

### **コア仮説の検証目標**
「既存SNSの攻撃的な雰囲気に疲れたユーザーは、**手動で管理された小さなコミュニティ**で、**ポジティブな投稿のみが共有される場**を求めている」

### **個人開発MVPの大幅絞り込み戦略**
個人開発では「完璧より実現可能性」を最優先とし、手動運用と既存サービス活用で開発負荷を最小化

### **MVPに含める超絞り込み機能**

#### **Phase 0: 最小限MVP（3-4ヶ月目標）**
1. **申請・承認制ユーザー登録**
   - **理由:** コミュニティの質確保、ポートフォリオとしての完成度向上
   - **実装:** 簡単な申請フォーム + 管理者による手動承認

2. **Google認証によるログイン機能**
   - **理由:** 承認済みユーザーの安全なログイン
   - **実装:** Google OAuth + 承認済みユーザーチェック

3. **投稿機能（テキストのみ、500文字）**
   - **理由:** Sanctuaryのコア体験「ポジティブな投稿共有」
   - **制限:** 画像・動画・リンクは完全に除外

4. **投稿一覧（タイムライン）**
   - **理由:** 投稿を見る基本機能
   - **仕様:** 全ユーザーの投稿を時系列表示（フォロー機能なし）

5. **Python自作AI審査システム**
   - **理由:** 転職ポートフォリオとして技術力をアピール、投稿品質の自動確保
   - **実装:** 感情分析・ネガティブワード検出による投稿審査 + 管理画面での最終確認

6. **基本プロフィール（名前のみ）**
   - **理由:** ユーザー識別の最小限
   - **実装:** Googleアカウントの名前・アイコンをそのまま使用

### **MVPから完全除外する機能**

#### **除外理由：個人開発リソースの現実**
1. **複雑なユーザー管理機能**
   - **除外理由:** 高度な権限管理、プライバシー機能の実装コストが過大
   - **代替案:** 基本的な申請承認制はMVPに含める、高度な管理機能は後日実装

2. **外部LLM API（GPT-4等）連携**
   - **除外理由:** 外部API依存、コスト、エラーハンドリングの複雑性
   - **代替案:** Python自作AI審査システムでMVP実装、外部LLMはPhase 5以降で検討

3. **リアクション・コメント機能**
   - **除外理由:** 複雑なデータ構造、通知機能、モデレーション負荷
   - **代替案:** フェーズ2で最優先実装

4. **フォロー・DM機能**
   - **除外理由:** 高度な権限管理、プライバシー機能が必要
   - **代替案:** フェーズ3以降で検討

5. **感謝の木・ゲーミフィケーション**
   - **除外理由:** 複雑な計算ロジック、グラフィックデザイン
   - **代替案:** コミュニティが安定してから検討

6. **画像・動画投稿**
   - **除外理由:** ストレージ管理、圧縮、モデレーション負荷
   - **代替案:** テキストでのコミュニケーション特化

---

## **2. 個人開発ロードマップ**

### **全体スケジュール概要**
- **MVP開発期間:** 3〜4ヶ月（週末・夜間開発想定）
- **開発者:** 1名（フルスタック開発）
- **リリース目標:** 2025年11月〜12月
- **開発方針:** 既存サービス最大活用、手動運用優先
- **開発アプローチ:** ⭐ **機能優先開発（実装→動作確認→次の機能）**

---

### **Phase 1: 技術選定・環境構築（期間：2週間）**

#### **目的**
個人開発に適した技術スタック選定と最小限の開発環境構築

#### **技術スタック（個人開発最適化）**

**【フロントエンド】**
- **Next.js + TypeScript:** 高速開発、SSR/SSG、APIルート一体化
- **Tailwind CSS:** 高速スタイリング、UIフレームワーク不要
- **Shadcn/ui:** 高品質なコンポーネント、カスタマイズ容易

**【バックエンド・インフラ】**
- **Hono + TypeScript:** 高速で軽量なバックエンド
  - **言語:** TypeScript
  - **フレームワーク:** Hono
  - **データベース:** PostgreSQL 15+ (Docker)
  - **ORM:** Prisma
  - **認証:** Auth.js v5 + Prisma Adapter（Google OAuth完全実装済み）
  - **API設計:** RESTful API
- **デプロイ環境:**
  - **フロントエンド:** Vercel (Next.js)
  - **バックエンド:** Railway / Render / Fly.io
  - **開発環境:** Docker + Docker Compose

**【テスト】**
- **フロントエンド:**
  - Jest + React Testing Library: コンポーネントテスト
  - Playwright: E2Eテスト
  - MSW: APIモック
- **バックエンド:**
  - Jest/Vitest: ユニット・統合テスト
  - Hono Test: APIテスト
  - Testcontainers: データベーステスト
- **実用テスト:** 重要機能における必要十分なテスト、統合・E2Eテストでの品質保証

**【状態管理】**
- **Zustand / Redux Toolkit:** アプリケーションの複雑性に応じた状態管理

**【監視・分析】**
- **Sentry:** エラー監視
- **Google Analytics:** ユーザー行動分析

**【CI/CD】**
- **GitHub Actions:** 自動テスト、Lint、デプロイ

**【開発・運用】**
- **GitHub:** ソースコード管理、GitHub Actions CI/CD
- **API文書:** Swagger/OpenAPI 3.0
- **ログ:** Logback + SLF4J
- **設定管理:** 環境変数
- **マイグレーション:** golang-migrate
- **監視:** Sentry (エラー監視)
- **分析:** Google Analytics

#### **主要タスク**
- [x] P1.1 プロジェクト初期設定（Next.js + TypeScript）
  - **実装内容:** `npx create-next-app@latest --typescript` を実行し、プロジェクトの雛形を作成します。
- [x] P1.2 Hono + TypeScript環境構築 ⭐ **完了**
  - **実装内容:** Node.js、npm/yarn、VS Code環境を構築し、Hono + TypeScriptプロジェクトを初期化します。
- [x] P1.3 PostgreSQL接続・Prisma設定 ⭐ **完了**
  - **実装内容:** 既存Docker PostgreSQLに接続し、Prisma ORMの設定を行います。
- [x] P1.4 GitHub リポジトリ作成・Vercel連携
  - **実装内容:** GitHubにリポジトリを作成し、Vercelと連携して自動デプロイを設定します。
- [x] P1.5 Tailwind CSS + Shadcn/ui セットアップ **[参照: 主要画面要素定義]**
  - **実装内容:** `npx shadcn-ui@latest init` を実行し、必要なコンポーネントを導入します。
- [x] P1.5.4 コード品質ツールの導入 (ESLint, Prettier)
  - **実装内容:** ESLintとPrettierを導入し、`.eslintrc.json` と `.prettierrc` を設定します。
- [ ] P1.6 開発・本番環境の分離設定
  - **実装内容:** Hono環境変数設定とNext.jsフロントエンドの環境変数を設定し、開発・本番環境を分離します。

---

### **Phase 1.7: テスト基盤構築（期間：1週間）**

#### **目的**
必要に応じたテスト環境の構築

#### **主要タスク**
- [x] P1.7.1 Jest + React Testing Library 詳細セットアップ
  - **実装内容:** `jest.config.ts` と `jest.setup.ts` を設定し、テストの実行環境を構築します。
- [x] P1.7.2 E2Eテスト環境構築（Playwright/Cypress）
  - **実装内容:** Playwrightを導入し、`playwright.config.ts` を設定します。
- [x] P1.7.3 テストデータ管理戦略の確立
  - **実装内容:** テストデータの生成とクリーンアップを行うスクリプトを作成します。
- [ ] P1.7.4 Hono API モック戦略の文書化
  - **実装内容:** MSWを使用したHono API のモック戦略を実装し、フロントエンドテストで活用します。
- [ ] P1.7.5 コードカバレッジとCI/CD統合
  - **実装内容:** GitHub Actionsでテストとカバレッジレポートの生成を自動化します。

---

### **緊急対応：既存実装のテスト補強（期間：1週間）**

#### **目的**
既に実装済みの機能に対する品質保証とリグレッション防止のためのテスト作成

#### **主要タスク**
- [x] RT.1 AuthContext コンポーネントのテスト作成
  - **実装内容:** `__tests__/auth-context.test.tsx` にて、認証状態の変更やユーザー情報の取得に関するテストを記述します。
- [x] RT.2 Header/Footer レイアウトコンポーネントのテスト作成
  - **実装内容:** `__tests__/Header.test.tsx` にて、認証状態に応じたUIの表示切り替えやログアウト機能のテストを記述します。
- [ ] RT.3 JWT認証フローの統合テスト作成
  - **実装内容:** Playwrightを使用して、ログイン・JWT取得・認証状態管理のE2Eテストを作成します。
- [ ] RT.4 PostForm コンポーネントのレトロテスト作成 ⭐ **P2.5.4と統合実施**
  - **実装内容:** `__tests__/PostForm.test.tsx` にて、入力値のバリデーションやフォーム送信処理のテストを記述します。

---

### **Phase 2: MVP開発（期間：10〜12週間）**

#### **目的**
超絞り込み機能での最小限SNSを3ヶ月で完成させる

#### **機能優先開発スケジュール**

**Week 1-2: Hono基盤・申請承認制**
- [x] P2.1 Hono API サーバー基盤構築 ⭐ **完了**
  - **実装内容:** Honoプロジェクト作成、Prisma設定、基本的なルーティングとハンドラー、ミドルウェア統合（CORS、ログ、エラーハンドリング）
- [ ] P2.2 申請・承認制システム実装 (FUNC-001, FUNC-002)
  - **実装内容:** 申請フォーム、承認待ちユーザー管理、管理者承認機能
- [x] P2.3 Google認証 + 承認済みユーザーチェック (FUNC-003) ⭐ **完了**
  - **実装内容:** Auth.js v5による Google OAuth実装、セッション管理、認証フロー完全実装
- [x] P2.4 基本レイアウト・ナビゲーション ⭐ **完了**

**Week 3-4: 投稿機能API・フロントエンド連携**
- [x] P2.5 投稿CRUD API実装 (FUNC-004) ⭐ **完了**
  - **実装内容:** 投稿作成・取得・更新・削除のRESTful API、Hono + Prismaによる完全なCRUD操作
- [x] P2.6 Prisma とPostgreSQL連携 (FUNC-004) ⭐ **完了**
  - **実装内容:** Prismaスキーマ定義、Prisma Client実装、トランザクション処理
- [x] P2.7 バリデーション機能 (FUNC-004) ⭐ **完了**
  - **実装内容:** 投稿内容の文字数制限、HTMLサニタイゼーション、エラーハンドリング（Zodなどのライブラリを活用）
- [x] P2.8 フロントエンド API連携 (FUNC-004-1) ⭐ **完了**
  - **実装内容:** Next.js から Hono API への HTTP通信、BFFパターンによるAuth.js認証連携、状態管理

**Week 5-6: タイムライン機能・API最適化**
- [x] P2.8.1 Auth.js標準スキーマでテーブル再設計 ⭐ **完了**
  - **実装内容:** Auth.js標準スキーマ（User, Account, Session）+ アプリ用UserProfileテーブルの設計・実装
  - **完了内容:** PostgreSQL用Auth.js標準スキーマ設計、UserProfileテーブルでSanctuary固有情報管理、リレーション設定完了
- [x] P2.8.2 Prisma Adapterによる認証システム最適化 ⭐ **完了**
  - **実装内容:** 既存手動実装からPrisma Adapterを使用したAuth.js標準設計への移行
  - **完了内容:** PrismaClientシングルトン実装、Google OAuth完全動作、セッション管理自動化、Next.js Image外部ホスト設定完了

**【P2.8.1 & P2.8.2 次のステップ（推奨）】**
- **P2.8.3 UserProfile連携コールバック実装**: セッション作成時の自動UserProfile作成
- **P2.8.4 承認制システム連携**: UserProfile.statusに基づくアクセス制御
- **P2.8.5 認証エラーハンドリング強化**: 承認待ち・拒否状態のUX改善
- [x] P2.9 投稿一覧API・フロントエンド表示 (FUNC-004) ⭐ **完了**
  - **実装内容:** 新しいAuth.js設計に対応したHonoによる投稿一覧取得API、Next.js での Timeline コンポーネント表示
  - **完了内容:** Supabase依存削除、HonoのGET/POSTエンドポイント実装、Next.js Timeline表示、UserProfile連携、段階的承認プロセス（pending→approved）実装、将来のAI審査システム準備完了
- [x] P2.10 時系列ソート・ページネーション API ⭐ **完了**
  - **実装内容:**
    - Prismaでソート・ページネーション機能を実装します。
    - フロントエンドにページネーションUIを追加します。
  - **完了内容:** HonoでのPagenation対応（limit/offset/cursor）、時系列ソート（createdAt desc）、hasNextPage判定、nextCursor生成機能実装
- [x] P2.11 投稿者情報JOIN取得・表示 (FUNC-011) ⭐ **完了**
  - **実装内容:**
    - Prismaでユーザー情報をJOIN取得するAPIを実装します。
    - PostCard コンポーネントに投稿者情報を表示します。
  - **完了内容:** Prisma include文でUserProfile→User JOIN取得、フロントエンドPostCard/Timeline表示、Google認証ユーザー情報連携実装
- [x] P2.12 ポーリング・リアルタイム風更新 ⭐ **完了**
  - **実装内容:**
    - 定期的なAPI ポーリングによる新規投稿の自動更新機能を実装します。
  - **完了内容:** usePostsTimelineフックに30秒間隔のポーリング機能を実装、HonoAPIのsinceパラメーター対応、重複排除ロジック（Set使用）、UI状態管理（開始/停止ボタン）、適切なクリーンアップ処理、技術ドキュメント「APIポーリング完全理解ガイド」作成完了

**Week 7-8: Python AI審査システム・管理機能**
- [x] P2.13 Python AI審査システム構築 (FUNC-006) ⭐ **完了**
  - **実装内容:**
    - Python（FastAPI）で感情分析・ネガティブワード検出APIを実装します。
    - Cardiff NLP多言語BERTモデルによる高精度感情分析実装。
    - HonoからPython APIへの連携機能を追加します。
  - **完了内容:** FastAPI + BERT感情分析 + ネガティブワード検出の完全実装、Hono連携、ユーザーフレンドリーなフィードバック機能、拒否時の投稿内容保持・改善提案UI実装
- [ ] P2.14 JWT管理者権限システム (FUNC-002)
  - **実装内容:**
    - JWT Claims に role フィールドを追加し、管理者権限を実装します。
    - 管理者専用ミドルウェアを作成します。
- [ ] P2.15 管理画面・管理API (FUNC-002)
  - **実装内容:**
    - 管理者専用のAPI エンドポイントを実装します。
    - Next.js で管理画面UIを作成します。
- [ ] P2.16 投稿削除・ユーザー管理API (FUNC-013, FUNC-014)
  - **実装内容:**
    - 投稿削除、ユーザー状態変更のAPI を実装します。
    - 管理画面からの操作UIを追加します。

**Week 9-10: プロフィール・設定**
- [x] P2.17 ユーザープロフィールAPI・画面 (FUNC-011) ⭐ **完了**
  - **実装内容:**
    - ユーザー情報取得・更新APIを実装します。
    - プロフィール表示・編集画面を作成します。
  - **完了内容:** Hono profile API（GET/PUT /me, GET /:userId）、Next.js profile page、ProfileView/ProfileEditFormコンポーネント、ヘッダーnavigation連携、Auth.js v5 session.user.id統合、nickname表示統一、型定義完全実装
- [ ] P2.18 設定画面・アカウント管理 (FUNC-015)
  - **実装内容:**
    - パスワード変更、アカウント削除APIを実装します。
    - 設定画面でJWT認証管理機能を追加します。
- [ ] P2.19 レスポンシブデザイン
  - **実装内容:**
    - スマートフォンやタブレットなど、さまざまなデバイスで適切に表示されるように、レスポンシブデザインを実装します。

**Week 11-12: デプロイ準備**
- [ ] P2.20 本番環境構築
  - **実装内容:**
    - フロントエンド: Vercel デプロイ
    - バックエンド: Cloudflare Workers / Vercel Edge Functions / Railway でHono API デプロイ
    - PostgreSQL: 本番データベース構築
- [ ] P2.21 動作テスト・バグ修正
  - **実装内容:**
    - 本番環境でアプリケーションの動作テストを行い、バグを修正します。
- [ ] P2.22 パフォーマンス最適化
  - **実装内容:**
    - Lighthouseなどのツールを利用して、アプリケーションのパフォーマンスを測定し、最適化します。
- [ ] P2.23 利用規約・プライバシーポリシー
  - **実装内容:**
    - 利用規約とプライバシーポリシーを作成し、アプリケーション内に表示します。

---

### **Phase 3: リリース準備（期間：1〜2週間）**

#### **目的**
安全なリリースと初期ユーザー獲得の準備

#### **主要タスク**
- [ ] P3.1 本番環境での最終動作確認
  - **実装内容:** Playwrightを使用して、主要なユーザーシナリオのE2Eテストを本番環境で実行します。
- [ ] P3.2 セキュリティ設定の確認（JWT・API・DB）
  - **実装内容:** JWT セキュリティ、API 認証、PostgreSQL アクセス制御の設定を確認します。
- [ ] P3.3 ドメイン設定・SSL証明書
  - **実装内容:** Vercelの管理画面でカスタムドメインを設定し、SSL証明書を有効化します。
- [ ] P3.4 Google Analytics・Sentry（エラー監視）導入
  - **実装内容:** フロントエンド・バックエンド両方にGoogle AnalyticsとSentryを導入し、監視体制を構築します。
- [ ] P3.5 Python AI審査システムの最適化
  - **実装内容:** Python AI審査システムを本番環境用に最適化し、応答速度とパフォーマンスを向上させます。
- [ ] P3.6 友人・知人への事前共有（5〜10名程度）
  - **実装内容:** アプリケーションのURLを共有し、フィードバックを収集します。

---

### **Phase 4: MVPリリース & 運用開始**

#### **リリース戦略**

**【ソフトローンチ】**
- [ ] P4.1 友人・知人中心の小さなコミュニティ（10〜30名）
- [ ] P4.2 Twitter・Bluesky等での告知
- [ ] P4.3 個人ブログでのアプリ紹介記事

**【手動運用体制】**
- [ ] P4.4 投稿モデレーション：毎日1〜2回チェック（朝・夜）
- [ ] P4.5 ユーザーサポート：メール・Twitter DM対応
- [ ] P4.6 バグ修正：週末中心の開発サイクル

#### **成功指標（現実的KPI）**
- **アクティブユーザー:** 20〜50名
- **投稿承認率:** 90%以上
- **ユーザー継続率:** 1週間後30%、1ヶ月後20%
- **コミュニティ健全性:** 0件の誹謗中傷報告

---

### **Phase 4.5: UI/UX改善提案（優先実装推奨）**

#### **現在実装状況に基づく改善提案**
コードベース解析により特定された、ユーザー体験向上のための重要な改善項目

##### **🔥 最優先UI/UX改善（即座実装推奨）**

**UX-01: 申請・承認制のユーザー登録フロー改善**
- **現状:** UserProfile.statusフィールドは実装済みだが、UI未実装
- **改善提案:** 
  - 申請フォーム作成（興味分野、利用目的、コミュニティルール同意）
  - 申請済み状態の待機画面（承認までの流れ説明、推定時間表示）
  - 承認通知メール機能
- **実装優先度:** 最高（MVPリリースに必須）

**UX-02: プロフィール画面の実装**
- **現状:** UserProfileテーブル設計済み、Google認証ユーザー情報取得済み
- **改善提案:**
  - マイプロフィール表示画面（投稿履歴、いいね履歴、参加日）
  - プロフィール編集機能（自己紹介、興味分野、公開設定）
  - 他ユーザープロフィール閲覧機能
- **実装優先度:** 高（ユーザーエンゲージメント向上）

**UX-03: 投稿フォーム体験の向上**
- **現状:** 基本機能実装済み、AI審査フィードバック機能あり
- **改善提案:**
  - 下書き保存機能（LocalStorage活用）
  - 投稿テンプレート提供（感謝、応援、お礼など）
  - 文字数カウンターの視覚的改善（プログレスバー）
  - 投稿成功時のアニメーション効果
- **実装優先度:** 中（投稿体験の向上）

##### **🎯 中優先UI/UX改善（1-2週間後実装）**

**UX-04: タイムライン表示の改善**
- **現状:** 基本的なタイムライン表示、ポーリング機能実装済み
- **改善提案:**
  - 投稿カードのデザイン改善（シャドウ、角丸、スペーシング）
  - 新着投稿の視覚的強調（背景色変化、フェードイン効果）
  - スケルトンローディング実装
  - 無限スクロール対応（現在はページネーション）
- **実装優先度:** 中（ユーザー体験の向上）

**UX-05: エラーハンドリング・フィードバック改善**
- **現状:** 基本的なエラーハンドリング実装済み
- **改善提案:**
  - Toast通知システム実装（成功・エラー・警告）
  - ネットワークエラー時のリトライ機能
  - オフライン状態の検出・表示
  - 503エラー時のメンテナンス画面
- **実装優先度:** 中（信頼性の向上）

**UX-06: AI審査システムの透明性向上**
- **現状:** BERT感情分析実装済み、ユーザーフレンドリーメッセージ実装済み
- **改善提案:**
  - 審査結果の詳細表示（感情分析スコア、検出理由の可視化）
  - 投稿品質のリアルタイムフィードバック（入力中の感情分析）
  - 改善提案の具体化（「より前向きな表現例」を提示）
  - 審査基準の透明化（ヘルプページでスコア閾値公開）
- **実装優先度:** 中（透明性とユーザー教育）

##### **🚀 長期UI/UX改善（Phase 5以降）**

**UX-07: アクセシビリティ改善**
- **改善提案:**
  - キーボードナビゲーション対応
  - スクリーンリーダー対応（ARIA labels）
  - 色覚多様性対応（カラーユニバーサルデザイン）
  - フォントサイズ・コントラスト設定
- **実装優先度:** 低（包摂性向上）

**UX-08: モバイル体験の最適化**
- **現状:** Tailwind CSSでレスポンシブ対応済み
- **改善提案:**
  - スワイプジェスチャー対応
  - プルトゥリフレッシュ機能
  - PWA対応（ホーム画面追加、オフライン機能）
  - モバイル専用UI最適化
- **実装優先度:** 低（モバイルユーザー体験）

**UX-09: パフォーマンス・体感速度向上**
- **改善提案:**
  - 画像の遅延読み込み（Lazy Loading）
  - 投稿の仮想化（React Window）
  - Service Worker活用
  - Critical CSS インライン化
- **実装優先度:** 低（パフォーマンス最適化）

##### **📊 UI/UX測定・分析提案**

**測定項目:**
- 投稿完了率（フォーム開始→投稿成功）
- AI審査通過率の推移
- ユーザー滞在時間・ページビュー
- エラー発生率・リトライ成功率
- モバイル/デスクトップ利用率

**A/Bテスト候補:**
- 投稿フォームのデザイン（シンプル vs 詳細）
- AI審査フィードバックの表示方法
- タイムラインの投稿表示順序
- 新規ユーザーオンボーディングフロー

---

### **Phase 5: Post-MVP（リリース後 3ヶ月〜）**

#### **拡張機能（優先順位）**

**第1優先（3-6ヶ月後）：JWT認証移行・リアクション機能**
- [ ] P5.0 JWT認証システムへの移行
  - **実装内容:** Google認証からJWT認証への段階的移行、既存ユーザーデータの移行
- [ ] P5.1 「ありがとう」「応援」「共感」ボタン (FUNC-008)
  - **実装内容:** `reactions`テーブルを作成し、投稿に対してリアクションを追加・削除する機能を実装します。

**第2優先（6-9ヶ月後）：コメント機能**
- [ ] P5.2 投稿へのコメント投稿・表示 (FUNC-009)
  - **実装内容:** `comments`テーブルを作成し、投稿に対してコメントを追加・表示する機能を実装します。

**第3優先（9-12ヶ月後）：招待制システム**
- [ ] P5.3 招待システムAPI・UI (FUNC-001)
  - **実装内容:** 招待コード生成・管理API を実装し、招待制ユーザー登録フローを構築します。

**長期検討：感謝の木・高度なAI機能**
- [ ] P5.4 外部LLM API連携モデレーション (FUNC-006, FUNC-007)
  - **実装内容:** OpenAI API等とHono API を連携し、高度な投稿レビュー機能を実装します。
- [ ] P5.5 感謝の木 (FUNC-012)
  - **実装内容:** ユーザーの「感謝」リアクションに基づいて成長する「感謝の木」のロジックとUIを実装します。

---

## **3. 個人開発リスク管理**

### **個人開発特有のリスクと対策**

#### **【最重要】モチベーション維持リスク**
- **リスク:** 長期間の単独開発によるモチベーション低下、挫折
- **対策:**
  - 週次の小さな目標設定（「今週はログイン機能完成」）
  - 進捗のSNS共有（#個人開発 #Sanctuary）
  - 開発コミュニティ参加（Discord、Slack）
  - 2週間に1度の休息期間設定

#### **技術的課題解決の遅延**
- **リスク:** 1人で技術的問題に行き詰まる
- **対策:**
  - Stack Overflow、GitHub Issues での積極的な質問
  - 公式ドキュメントの熟読（Hono、TypeScript、Prisma、Next.js）
  - TypeScript・Node.js・個人開発コミュニティへの参加
  - 1日以上同じ問題で悩んだら代替手段を検討
  - TypeScript・Honoの豊富な学習リソース活用

#### **スコープクリープ（機能肥大化）**
- **リスク:** 開発中に新機能を追加したくなる衝動
- **対策:**
  - MVPスコープの厳格な文書化・定期確認
  - 新アイデアは「Phase 5アイデアメモ」に記録して後回し
  - 友人・知人への定期的な進捗報告でコミット

#### **運用負荷の過大**
- **リスク:** 手動モデレーション、ユーザーサポートの負荷増大
- **対策:**
  - 初期ユーザー数の意図的制限（50名まで）
  - モデレーション時間の事前設定（朝10分、夜10分）
  - 問い合わせ対応の定型化・FAQ整備
  - 荒らし対策のシンプルなブロック機能

### **成功指標（個人開発現実版）**

#### **MVP段階（リリース後3ヶ月）**
- **コミュニティサイズ:** 20〜50名のアクティブユーザー
- **投稿品質:** 手動承認で95%以上が健全な投稿
- **継続率:** 1週間後30%、1ヶ月後20%（小さなコミュニティなので低めでも健全）
- **開発者負荷:** 週5時間以内の運用時間

#### **成長段階（リリース後6〜12ヶ月）**
- **コミュニティ拡大:** 100〜200名のアクティブユーザー
- **エンゲージメント:** 1日平均5〜10投稿
- **健全性維持:** 誹謗中傷報告ゼロ件
- **技術的安定性:** 99%以上の稼働率

---

## **4. 個人開発成功のポイント**

### **技術選定の原則**
- **既存知識の活用:** TypeScript経験を活かしたHono習得
- **シンプルな設計:** 過度な抽象化、複雑なアーキテクチャは避ける
- **既存ライブラリ重視:** Hono、Prisma等の実績あるライブラリ活用
- **技術的独立性:** ベンダーロックイン回避、完全な制御権確保

### **開発効率化戦略**
- **UIフレームワーク活用:** Shadcn/ui、Tailwind CSS で高速開発
- **テンプレート活用:** Next.js のスターターテンプレート使用
- **自動化:** Vercel、GitHub Actions でデプロイ自動化
- **MVP思考の徹底:** 「動くけど美しくない」を許容

### **持続可能な運用体制**
- **手動運用の効率化:** 管理画面での一括操作、キーボードショートカット
- **時間制限の設定:** 開発・運用時間の明確な上限設定
- **バーンアウト防止:** 週1日の完全休息日、月1回の長期休暇
- **成功・失敗の記録:** 学習ログとして振り返り資料作成
- **品質管理:** 必要なテストの実行、コード品質の維持**

---

## **5. 開発指針と品質管理**

### **開発指針**
- **機能優先:** 実装→動作確認→次の機能のサイクル
- **実用性重視:** ユーザーが使える形まで素早く完成
- **技術幅拡大:** 多くのアプリ作成で実装技術の向上

### **品質管理**
- **必要なテスト:** 重要な機能やバグ修正時に必要に応じて実施
- **コードレビュー:** 定期的なコード品質の確認と改善
- **ドキュメント:** 仕様書や設計書の更新

---

## **6. 最終メッセージ**

このロードマップは、**個人開発者が現実的に完成できる範囲**で「心の安全地帯」を実現し、**機能優先で効率的な開発**を行う実践的計画です。

### **個人開発の魅力を活かす**
- **迅速な意思決定:** チーム合意不要でサクサク進む
- **ユーザーとの距離の近さ:** 直接フィードバックを受け取り、即座に反映
- **技術の学習機会:** フルスタック開発でスキルアップ
- **小さくても意義のあるコミュニティ:** 100名でも十分に価値のある場

### **重要な心構え**
- **機能実装重視:** ⭐ **動作する機能を素早く実装し、必要に応じてテストを追加**
- **実用性ファースト:** ⭐ **ユーザーが使える形まで素早く完成**
- **ユーザーと共に成長:** 一人で完璧な物を作るより、ユーザーと一緒に育てる
- **持続可能な品質:** ⭐ **必要に応じてリファクタリングでコード品質を向上**
- **楽しみながら開発:** 義務感より「作る楽しさ」と「実用性」を大切に

**🛠️ あなたが作る小さなSanctuaryが、誰かの心の支えになりますように。**

**⭐ 機能優先で、素早く実用的なアプリを作り上げる。**

---

**Honoバックエンドによる価値:**

### **採用による効果**
- **技術的独立性:** ベンダーロックインからの解放、完全な制御権
- **学習効率:** TypeScript経験を活かしたHono・Prisma等の技術習得
- **エッジコンピューティング対応:** 高速なエッジ環境でのデプロイと実行
- **システム制御性:** 全ての認証・認可・データベースロジックの完全掌握

---

## **現在の実装状況サマリー（2025年8月10日時点）**

### **🎯 完全実装済み（プロダクションレディ）**
- ✅ **認証システム**: Auth.js v5 + Google OAuth + Prisma Adapter + session.user.id統合
- ✅ **投稿CRUD機能**: バリデーション・エラーハンドリング・AI審査連携
- ✅ **タイムライン**: ページネーション・ポーリング・重複排除
- ✅ **Python AI審査**: BERT感情分析・ネガティブワード検出・UXフィードバック
- ✅ **プロフィール機能**: CRUD API・表示編集画面・ヘッダー連携・nickname統一表示
- ✅ **テスト基盤**: Jest + RTL + Playwright（主要コンポーネント）
- ✅ **データベース**: Prisma + PostgreSQL（Auth.js標準スキーマ）

### **🔧 基盤実装済み・UI未完成**
- 🔄 **申請・承認制**: UserProfile.statusフィールド実装済み、申請フォーム未実装
- 🔄 **リアクション機能**: Reactionテーブル設計済み、機能未実装

### **📈 MVP達成状況: 90%完了**
**残り主要タスク（MVPリリースまで）:**
1. **申請・承認制UI** - 即座実装可能（基盤完成済み）
2. **本番環境デプロイ** - Vercel + Railway設定

**推定MVP完成時期**: 2025年8月中旬（1週間）

---

**更新履歴追記:**
- **2025年8月10日 (v5.8.0)**: **P2.17 ユーザープロフィール機能完全実装**
  - P2.17 ユーザープロフィールAPI・画面が完了
  - Hono profile API（GET/PUT /me, GET /:userId）実装
  - Next.js profile page（/profile）、ProfileView/ProfileEditFormコンポーネント実装
  - ヘッダーnavigation連携、プロフィールボタン追加
  - Auth.js v5 session.user.id問題解決（session callbackでuser.id統合）
  - 認証方式統一（全APIでsession.user.id使用）
  - nickname表示統一（ヘッダー・投稿者名でプロフィールnickname表示）
  - 型定義完全実装（ProfileData・Post型のstatus対応）
  - MVP達成状況90%に到達、リリースまで残り申請承認制UIのみ
- **2025年8月5日 (v5.7.0)**: **P2.13 Python AI審査システム完全実装 + ロードマップ実装状況完全更新**
  - P2.13 Python AI審査システム構築が完了
  - FastAPI + Cardiff NLP多言語BERTモデルによる高精度感情分析実装（98%精度）
  - ネガティブワード検出機能完全実装
  - Hono TypeScript APIとの完全連携実装
  - ユーザーフレンドリーなフィードバック機能（投稿内容保持・改善提案UI）
  - 拒否された投稿の自動保持とユーザー向け改善ガイダンス機能
  - Python AI審査システムがプロダクションレディ状態に到達
- **2025年7月29日 (v5.4.0)**: **Auth.js標準認証システム完全実装**
  - P2.8.1 Auth.js標準スキーマでテーブル再設計が完了（User, Account, Session, UserProfile分離設計）
  - P2.8.2 Prisma Adapterによる認証システム最適化が完了（PrismaClientシングルトン、Google OAuth完全動作）
  - Next.js Imageコンポーネント最適化（外部ホスト許可設定、セキュアな画像読み込み）
  - Auth.js公式推奨パターン採用により、保守性とセキュリティが大幅向上
  - 次の実装候補：P2.9（投稿一覧API・フロントエンド表示）、UserProfile連携強化
- **2025年7月28日 (v5.3.0)**: **投稿CRUD API・フロントエンド連携完全実装**
  - P2.5 投稿CRUD API実装が完了（Hono + Prismaによる完全なCRUD操作）
  - P2.6 Prisma とPostgreSQL連携が完了（スキーマ定義、Client実装、トランザクション処理）
  - P2.7 バリデーション機能が完了（文字数制限、HTMLサニタイゼーション、エラーハンドリング）
  - P2.8 フロントエンド API連携が完了（BFFパターンによるAuth.js認証連携、状態管理）
  - Hono APIバックエンドとNext.jsフロントエンドの完全な連携動作確認済み
  - 外部キー制約エラーの発見により、Auth.js標準スキーマ再設計の必要性を確認
- **2025年7月27日 (v5.2.0)**: **Auth.js v5 Google認証システム完全実装**
  - P2.3 Google認証 + 承認済みユーザーチェックが完了
  - Auth.js v5（NextAuth Beta）による最新認証システム実装
  - Google Cloud Console OAuth 2.0設定と連携完了
  - セッション管理とGoogle認証フローの完全動作確認済み
  - 既存Supabase認証からAuth.jsへの完全移行完了
  - 認証システム基盤が確立され、投稿CRUD API（P2.5）実装準備完了
- **2025年7月27日 (v5.1.0)**: **Hono API基盤構築完了**
  - P1.2 Hono + TypeScript環境構築が完了
  - P1.3 PostgreSQL接続・Prisma設定が完了（既存DBからスキーマ自動生成）
  - P2.1 Hono API サーバー基盤構築が完了
  - ミドルウェア統合：CORS（フロントエンド連携）、Logger（リクエスト追跡）、ErrorHandler（統一エラー処理）
  - 本格的なAPI開発の基盤が完成、次フェーズの機能実装準備完了
- **2025年1月27日 (v5.0.0)**: **TypeScript Honoバックエンド版**
  - TypeScript経験を活かしたHonoバックエンドに変更
  - 技術スタックをHono + TypeScript + PostgreSQL + Next.js に変更
  - 全Phase の実装内容をHono API ベースに更新
  - Docker PostgreSQL + Prismaに移行、技術的独立性を確保
  - JWT認証、RESTful API、Docker環境での開発フローに移行
- **2025年7月26日 (v2.4.1)**: 
  - P2.7 バリデーション（空投稿、文字数制限）が完了済みであることを確認・更新
  - 既存実装の詳細調査により、クライアントサイド・サーバーサイドの両方でバリデーション機能が完全実装済みであることを発見
  - PostFormコンポーネントでの空投稿防止・文字数制限・エラーハンドリングが包括的にテスト済み
  - API Route（/api/posts）での投稿内容バリデーションと適切なエラーレスポンスが実装・テスト済み
  - バリデーション機能に関する全6項目（P2.7.1〜P2.7.6）が実質的に完了状態
- **2025年7月26日 (v2.4.0)**: 
  - P2.6 既存postsテーブルスキーマでのデータ保存が完了
  - API Route実装とテスト作成
  - 5つの包括的テストで認証チェック、データベース操作、エラーハンドリングを完全カバー
  - 実際のPostgreSQLデータベースを使った統合テストによる品質保証
  - Red-Green-Refactorサイクルによるヘルパー関数リファクタリング
  - PostFormとAPI Routeの連携が完全に機能し、投稿機能がプロダクションレディ状態に到達
- **2025年7月23日 (v2.3.0)**: 
  - P2.5.5 フォーム送信処理の改善が完了
  - 包括的なフォーム送信処理の改善を実装
  - 実際のAPI呼び出し、HTTPエラー・ネットワークエラーハンドリング、成功時のフォームリセット、予期しないエラーへの耐性をテスト駆動で実装
  - Red-Green-Refactorサイクルによるコード品質向上とAPI呼び出しロジックのリファクタリング
  - Jest設定の改善（jest.setup.tsへの移行）によるTypeScript型エラーの解決
  - PostFormコンポーネントがプロダクション級の堅牢性を獲得
- **2025年7月21日 (v2.2.1)**: 
  - P2.5.4 PostFormコンポーネントのレトロテスト作成が完了
  - PostFormコンポーネントテストを実装
  - ユーザーイベント、文字数制限、バリデーション、送信状態管理、非同期処理の統合テスト
  - 技術記事「JestとRTLで学ぶ！非同期処理もバリデーションも怖くないReactフォームテスト入門」を作成
- **2025年1月18日 (v2.2.0)**: 
  - RT.2.1 【Component】Header コンポーネントの表示とログアウト機能テスト完了
  - Headerコンポーネントテストを実装
  - 認証状態に応じたUI表示切り替え、ユーザー情報表示優先度ロジック、ユーザーインタラクション（ログアウト）のテスト
  - 技術記事「認証ヘッダーをReact Testing Libraryでテストする方法」を作成
- **2025年8月1日 (v5.6.0)**: **P2.12ポーリング・リアルタイム風更新完全実装**
  - P2.12 ポーリング・リアルタイム風更新が完了（React + TypeScript + Hono完全連携）
  - usePostsTimelineフックに30秒間隔の自動ポーリング機能を実装
  - HonoAPIのsinceパラメーター対応（PostWhereCondition型拡張）
  - 効率的な重複排除ロジック（Set使用、O(n)計算量）
  - UI状態管理（ポーリング開始/停止ボタン、isPolling状態）
  - 適切なメモリリーク防止（useEffectクリーンアップ、setInterval管理）
  - 技術学習ドキュメント「APIポーリング完全理解ガイド」作成
  - リアルタイム風投稿更新機能がプロダクションレディ状態に到達
- **2025年7月30日 (v5.5.0)**: **P2.9投稿一覧機能完全実装**
  - P2.9 投稿一覧API・フロントエンド表示が完了（Hono + Next.js完全連携）
  - usePostsTimeline.tsをSupabaseからHono API呼び出しに完全移行
  - Next.js TimelineコンポーネントとAPI連携の実装完了
  - UserIDからUserProfileIDへの変換ロジック実装
  - 段階的承認プロセス（pending→approved）でAI審査システム準備完了
  - HonoとNext.jsの統合開発フローが確立、次フェーズ（P2.10以降）実装準備完了
- **2025年7月16日 (v2.1.1)**: 
  - 現在の実装状況を反映してタスクチェック状況を更新
  - P1.7.4 APIモック戦略の文書化が部分完了（認証のみ、DB操作は未実装）
  - RT.1 AuthContext コンポーネントのテスト作成が完了
  - P2.4.2 基本的なルーティング設定が部分完了（基本構造のみ）
  - 技術記事「【爆速理解】Next.js認証機能のテスト、もう怖くない！」を作成

**策定者:** 個人開発者  
**見直し頻度:** 毎月第一土曜日  
**次回更新:** 2025年2月15日
